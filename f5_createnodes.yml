---
- name: define and add webserver nodes to the loadbalancer
  hosts:
    - rhel_vms
    - win_vms
  gather_facts: true

  tasks:
    - when: ansible_os_family == "RedHat"
      delegate_to: localhost
      f5networks.f5_modules.bigip_node:
        host: "{{ ansible_eth1.ipv4.address }}"
        name: "{{ inventory_hostname }}"
        provider:
          password: admin
          server: f5
          user: admin
          validate_certs: false

    - when: ansible_os_family == "Windows"
      delegate_to: localhost

      #   - debug: var=ansible_distribution
      #   - debug: var=ansible_ip_addresses[2]

      #  - debug: var=ansible_eth1.ipv4.address
      #  - debug: var=ansible_devices.vda.partitions.vda1.size 
      f5networks.f5_modules.bigip_node:
        host: "{{ ansible_ip_addresses[2] }}"
        name: "{{ inventory_hostname }}"
        provider:
          password: admin
          server: f5
          user: admin
          validate_certs: false
